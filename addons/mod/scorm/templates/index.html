<ion-view>
    <ion-content padding="true" delegate-handle="mmaModScormIndexScroll" mm-state-class>
    	<ion-refresher pulling-text="{{ 'mm.core.pulltorefresh' | translate }}" ng-if="scormLoaded" on-refresh="refreshScorm(false)">
        </ion-refresher>
        <mm-loading hide-until="scormLoaded">
            <div class="mm-info-card-icon" ng-if="scorm.warningmessage">
                <i class="icon ion-information-circled padding"></i> {{ scorm.warningmessage }}
            </div>
	     
                <!-- Synchronize button -->
                <div class="mm-warning-card-icon" ng-if="!errorMessage && hasOffline">
                    <i class="icon ion-alert-circled padding"></i> {{ 'mm.core.hasdatatosync' | translate:{$a: moduleName} }}
                </div>
	            <!-- TOC -->
	            <div class="card" ng-if="(scorm.displaycoursestructure && organizations.length) || (organizations && organizations.length > 1)">
	        		<div class="item item-divider">{{ 'mma.mod_scorm.contents' | translate }}</div>
	        		<div ng-if="organizations && organizations.length > 1" class="item item-input item-select">
	                    <div class="input-label" id="mma-scorm-organizationslabel">
	                        {{ 'mma.mod_scorm.organizations' | translate }}
	                    </div>
	                    <select ng-model="currentOrganization.identifier" ng-options="org.identifier as org.title for org in organizations" ng-change="loadOrg()" aria-labelledby="mma-scorm-organizationslabel" mm-ios-select-fix>
	                    </select>
	                </div>
	                <div class="item text-center" ng-if="scorm.displaycoursestructure && loadingToc">
	                	<ion-spinner></ion-spinner>
	                </div>
	                <div class="item item-text-wrap" ng-if="scorm.displaycoursestructure && !loadingToc">
	                	<!-- If data shown doesn't belong to last attempt, warn it. -->
	                	<p ng-if="attemptToContinue">{{ 'mma.mod_scorm.dataattemptshown' | translate:{number: attemptToContinue} }}</p>
	                	<p>{{ currentOrganization.title }}</p>
	                	<div ng-repeat="sco in toc track by sco.id" class="mma-scorm-level-{{sco.level}}">
	                		<p ng-if="sco.isvisible">
	                			<img ng-src="{{sco.image.url}}" alt="{{sco.image.description}}" />
	                			<a href="#" id="openevent" ng-if="sco.prereq && sco.launch" ng-click="open($event, sco.id)">{{ sco.title }}</a>
	                			<span ng-if="!sco.prereq || !sco.launch">{{ sco.title }}</span>
	                		</p>
	                	</div>
	                </div>
	        	</div>
	            <!-- Open in browser button -->
                <div class="card padding" ng-if="errorMessage">
                	<p class="mma-mod-scorm-warning">{{ errorMessage | translate }}</strong></p>
                    <a class="button button-block icon-right ion-share" ng-href="{{moduleUrl}}" mm-link>{{ 'mm.core.openinbrowser' | translate }}</a>
                </div>
                <!-- Warning that you don't have any more attempts -->
                <div class="card padding" ng-if="!errorMessage && scorm.attemptsLeft <= 0">
                	<p class="mma-mod-scorm-warning">{{ 'mma.mod_scorm.exceededmaxattempts' | translate }}</p>
                </div>
	            <!-- Open SCORM in app form -->
                <form  id="startscorm1" class="card"  ng-if="!errorMessage && (!scorm.lastattemptlock || scorm.attemptsLeft > 0)" ng-submit="open($event)">
               		<!-- Open mode (Preview or Normal) -->
                	<div class="item" ng-if="!scorm.hidebrowse">
                		<p class="item-heading">{{ 'mma.mod_scorm.mode' | translate }}</p>
                		<p class="mma-mod-scorm-checkbox-padding">
                			<input type="radio" name="mode" ng-model="scormOptions.mode" value="{{modebrowse}}" aria-labelledby="mma-mod_scorm-browse">
                			<span id="mma-mod_scorm-browse">{{ 'mma.mod_scorm.browse' | translate }}</span>
                		</p>
                		<p class="mma-mod-scorm-checkbox-padding">
                			<input type="radio" name="mode" ng-model="scormOptions.mode" value="{{modenormal}}" aria-labelledby="mma-mod_scorm-normal">
                			<span id="mma-mod_scorm-normal">{{ 'mma.mod_scorm.normal' | translate }}</span>
                		</p>
                	</div>
               		<!-- Create new attempt -->
                    <ion-checkbox ng-if="!scorm.forcenewattempt && scorm.numAttempts > 0 && !scorm.incomplete && scorm.attemptsLeft > 0" class="item-text-wrap item-checkbox-right" ng-model="scormOptions.newAttempt">
                        <p class="item-heading">{{ 'mma.mod_scorm.newattempt' | translate }}</p>
                    </ion-checkbox>
                	<div class="item item-text-wrap" ng-if="!downloading">
                		<p ng-if="statusMessage">{{ statusMessage | translate }}</p>
	                    <button class="button button-block button-positive startscorm">{{ 'mma.mod_scorm.enter' | translate }}</button>
                	</div>
                	<div class="item text-center" ng-if="downloading">
	                	<ion-spinner></ion-spinner>
	                	<p ng-if="progressMessage">{{ progressMessage | translate }}</p>
	                	<p ng-if="percentage <= 100">{{ 'mm.core.percentagenumber' | translate:{$a: percentage} }}</p>
	                </div>
                </form>
	        </div>
	    </mm-loading>
    </ion-content>
</ion-view>